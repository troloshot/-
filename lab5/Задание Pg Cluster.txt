1. Настроить консул ( использовать уже готовую роль и инветори).
2. База данных должна быть проинициализирована на выделенных дисках (в Vargrantfile они уже подключены). VG должна называться pg, LV pg_data и pg_wal соответственно. Точки монтирования разделов /pgsql/pg_data и /pgsql/pg_wal. Файловая система для обоих LVM ext4.
3. БД должна находиться в папке /pgsql/pg_data/14. WAL архивы должны находиться в папке /pgsql/pg_wal/14.
4. На серверах pg1 и pg2 настроить оркестратор репликации Patroni (пакет в архиве).
5. С помощью утилиты vip-manager обеспечить настройку VIP адреса на мастер сервере. Напоминаю, что в конфиге vip-manager необходимо настроить подключение по DCS Consul. IP адрес подключения 127.0.0.1:8500. Так же нужно будет указать consul_token, переменную которого можно взять в роли consul.
6. В Postgres залить уже знакомую нам БД small из https://edu.postgrespro.ru/demo-small-20161013.zip
7. АБСОЛЮТНО ВСЕ ПЕРЕМЕННЫЕ, использующиеся в playbook должны быть заданы в едином group_vars.
P.S. Если кто не в понял, то всё нужно делать в ansible
